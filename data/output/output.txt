TODO: Validate input data assumptions here